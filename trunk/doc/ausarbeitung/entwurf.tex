\section{Entwurf}
\label{sec:entwurf}
//TODO: Einleitung zum Kapitel
Die praktische Umsetzung der im letzten Kapitel diskutierten Modelle ist wie folgt aufgegliedert.

\subsection{Anforderungen}
\label{sec:entwurf:anf}

Das Gebiet der Simulation von Komponentenarchitekturen ist z.Z. praktisch relativ unerforscht. Dieses Framework bildet den Versuch der Umsetzung einer Simulationsumgebung, ohne auf bereits bewährte Methoden auf diesem Gebiet zurückgreifen zu könnnen. Hierbei ergeben sich zwei zwingende funktionale Anforderungen.

\subsubsection{Bereitstellung von Basisfunktionalitäten}
\label{sec:entwurf:anf:basis}
Das Framework soll in allen im Folgenden erläuterten Bereichen zusammen lauffähige Basisfunktionalitäten bieten. Dies kann zum einen für den unveränderten Gebrauch von nöten sein, wobei dann ohne weitere Implementierungen Simulationen auf dem Framework ausgeführt werden können. Wichtiger in diesem Zusammenhang erscheint jedoch die gezielte Erweiterung an bestimmten Stellen des Framework, wobei andere Bereiche unverändert genutzt werden können. Die zu unterstützenden Bereiche der Simulationsumgebung lassen sich grob in drei Teile aufspalten. 

\begin{itemize}

\listitem{Modellierung einer Komponentenarchitektur}
Dieser Teil sorgt für die Umsetzung des in Kapitel \ref{sec:modell:grundlagen} vorgestellten Komponentenmodells. Hierbei gilt es, den Aufbau eines Architekturmodells in einem für die Simulation nutzbaren Format zu ermöglichen.
	
\listitem{Simulation von Anfragen}
Im zweiten Teil geht es um die Simulation von Anfragen an das mit dem ersten Teil aufgebauten Modell. Hierzu soll das Simulationsmodell aus Kapitel \ref{sec:modell:simulation} umgesetzt werden. 

\listitem{Erfassung von Simulationsdaten}
Hier sollen nun die während der Simulation enstandenen Daten gesammelt werden. Bei der Implementierung der Basisfunktionalität genügt es, Daten später auswerten zu können. Um jedoch auch während der Simulation Analysen vornehmen zu können, soll dieser Teil die Möglichkeit offen lassen, Daten auch direkt auswerten zu können.
\end{itemize}
	
\subsubsection{Möglichkeiten zum Austausch und zur Erweiterbarkeit}
\label{sec:entwurf:anf:erweit}

Aufgrund oben angesprochener Problematik, ist beim Entwurf des Frameworks darauf zu achten, das es möglichst modular aufgebaut ist. Das bedeutet, es müssen sich alle größeren Bestandteile des Frameworks austauschen lassen, ohne die Funktionalität anderer Bereiche ebenfalls ändern zu müssen. So ist es beispielsweise wünschenswert, den Teil für die Modulierung auf ein anderes Komponentenmodell umstellen zu können und mit diesem die Funktionalität des Simulations- und des Auswertungsteil verwenden zu können.\par
Weiterhin sollen die Basisimplementierungen nicht nur ausschließlich austauschbare Referenzimplementierungen sein, sondern die Möglichkeit der Erweiterung offen lassen.  

\subsection{Architektur des Frameworks}
\label{sec:entwurf:grob}

Wie in Kapitel \ref{sec:entwurf:anf:basis} erläutert, teilt sich das Framework in drei Bestandteile, das Modell, die Simulation und die Auswertung. Um diese Teile bereits in der Architekturebene möglichst unabhängig und damit austauschbar zu gestalten, werden Verbindungen dieser Ebenen untereinander nur über eine vierte übergeordnete Ebene zugelassen. Diese Ebene wird im folgenden als {\em Simulationsumgebung} oder {\em simulation environment} bezeichnet. Bild \ref{pic:architecture} verdeutlicht diesen Zusammenhang. Weiterhin zeigt dieses Bild (gestrichelt gezeichnet) eine Reihe von Erweiterungsmöglichkeiten und die Positionen, an denen sie ansetzen.

\begin{figure}[ht]
\begin{center}
\includegraphics[width=13.5cm]{../res/architektur.png}
\caption{Architektur des Frameworks mit Erweiterungsmöglichkeiten}
\label{pic:architecture}
\end{center}
\end{figure}

Im folgenden werden jetzt die drei oben erwähnten Bestandteile einzeln etwas genauer beleuchtet und die zu ihrer Umsetzung benötigten Komponenten identifiziert. Die Simulationsumgebung selber wird hier von der Betrachtung ausgeschlossen, da sie lediglich eine Ebene zur Verbindung der anderen Teile darstellt und somit keine weiteren Komponenten beinhaltet. Kapitel \ref{sec:entwurf:fein} widmet sich später der Paritionierung in Klassen und Datenstrukturen widmet. Dort wird näher auf die Simulationsumgebung eingegangen.

\subsubsection{Bestandteile des Modells}
\label{sec:entwurf:grob:modell}
Wie in Kapitel  \ref{sec:modell:grundlagen} beschrieben besteht dieses aus der Modellierung der Komponenten, deren Diensten und den Verbindungen zwischen ihnen. 
//TODO: Bescheiben, wenn aktuell... Abwarten bis CM fertig ist.

\subsubsection{Bestandteile der Simulation}
\label{sec:entwurf:grob:sim}
Das in Kapitel \ref{sec:modell:simulation} aufgestellte Modell benötigt zu seiner Umsetzung zwei Komponenten, die eigendlichen {\em Simulationsthreads} und einen {\em Scheduler}.\\
Die Threads halten alle Daten der Anfrage, die sie simulieren. Hierzu gehört der momentane Aufenthaltsort innerhalb der Komponentenarchitektur, der Weg dorthin  und die Zeit, bis das Thread zum nächsten zeitverbrauchenden Element wechseln kann. Weiterhin benötigen sie Informationen darüber, welche Daten sie zu sammeln haben. Hier bieten sich drei Möglichkeiten:
\begin{enumerate}

\item Das Thread sammelt überhaupt keine Daten. Diese Threads eigenen sich in Verbindung mit anderen Threads, um Belastungen zu simulieren, die dann andere Threads in ihrer Ausführung beinflussen.

\item Das Threads protokolliert alle Elemente der Komponentenarchitektur, die eine Markierung tragen.

\item Das Thread protokolliert alle Elemente auf seinem Weg.

\end{enumerate}

Der Scheduler dient der Verwaltung der Threads. Er sorgt für die Erstellung neuer Threads, die Berechnung der Grösse des nächstmöglichen Simulationsschrittes und die Entfernung von beendeten Threads.

//TODO: Noch mehr über Scheduler und Periodische Threads !!

\subsubsection{Bestandteile der Datenerfassung}
\label{sec:entwurf:grob:erfassung}
Zur Erfassung von Daten genügt an dieser Stelle eine ereignisgetriebene Komponente, die über die Simulationsumgebung im Simulationsteil des Frameworks registriert wird. Von dort aus werden, wie oben beschrieben, verschiedene Nachrichten an die Komponente versendet. 


\subsection{Feinentwurf}
\label{sec:entwurf:fein}
- Namespace und Klassen und 
Kommunikation intern und extern
